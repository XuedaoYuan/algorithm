<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Document</title>
  </head>
  <body>
    <script>
      /**
       * Definition for singly-linked list.
       * function ListNode(val, next) {
       *     this.val = (val===undefined ? 0 : val)
       *     this.next = (next===undefined ? null : next)
       * }
       */
      /**
       * @param {ListNode} head
       * @param {number} left
       * @param {number} right
       * @return {ListNode}
       */
      function ListNode(val, next) {
        this.val = val === undefined ? 0 : val;
        this.next = next === undefined ? null : next;
      }

      ListNode.prototype.showVal = function () {
        const result = [];
        let cur = this;
        while (cur) {
          result.push(cur.val);
          cur = cur.next;
        }
        return result;
      };

      var reverseBetween = function (head, left, right) {
        let pre = null;
        let cur = head;
        let index = 1;
        let leftPreNode, leftNode;
        while (cur) {
          if (index === left) {
            // 记录left之前的那个节点
            leftPreNode = pre;
            leftNode = cur;
          }
          if (left < index && index < right) {
            // 反转
            let next = cur.next;
            cur.next = pre;
            pre = cur;
            cur = next;
            index++;
            continue;
          }
          if (index === right && right !== left) {
            if (leftPreNode) {
              leftPreNode.next = cur;
            }else {
              // 不存在leftPreNode意味着left为1， 也就是从头开始的，这时候head需要变更
              head = cur
            }
            if (cur) {
              leftNode.next = cur.next;
              cur.next = pre;
            }
            break;
          }
          let next = cur.next;
          pre = cur;
          cur = next;
          index++;
        }

        return head;
      };

      let head = new ListNode(3);
      head.next = new ListNode(5);
      // head.next.next = new ListNode(3);
      // head.next.next.next = new ListNode(4);
      // head.next.next.next.next = new ListNode(5);

      console.log(head.showVal());
      head = reverseBetween(head, 1, 2);

      console.log(head.showVal());
    </script>
  </body>
</html>
